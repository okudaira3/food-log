# discussion-with-gemini

Gemini CLI を使用して、現在の作業について詳細な議論を行い、多角的な分析と反復的な改善を通じて Claude Code の精度を向上させます。

## 前提条件
このコマンドを使用する前に、以下の点を確認してください。
- Gemini CLI がインストールされている（`gemini` コマンドが使用可能）
- `gcloud auth application-default login` で認証されている

## 実行手順

1. **現在のコンテキストの収集**
まず、現在の作業に関する情報を収集します。
```bash
# Git のステータスと最近の変更を確認する
!git status --porcelain
!git diff --cached
!git diff
!git log --oneline -10
```

2. **ディスカッショントピックの準備**
コンテキストに基づいて、以下のトピックを網羅したディスカッションポイントを準備します。
- アーキテクチャと設計パターン
- パフォーマンスとスケーラビリティ
- 保守性とコード品質
- セキュリティに関する考慮事項
- ベストプラクティスの整合

3. **Gemini ディスカッションを開始する**
包括的なプロンプトを作成し、ディスカッションを開始します。
```bash
# コンテキストと質問を含む一時ファイルを作成する
!echo "[ディスカッションプロンプトはここに表示されます]" > /tmp/gemini_discussion.md

# Gemini とのインタラクティブなディスカッションを開始します
!gemini -p < /tmp/gemini_discussion.md
```

4. **反復的な改善**
Gemini の最初の回答に基づいて、以下の作業を行います。
- より詳細な分析が必要な領域を特定します。
- フォローアップの質問を作成します。
- 3～5ラウンドにわたってディスカッションを継続します。

各ラウンドでは、以下の点を検討します。
- 代替アプローチとトレードオフ
- コード例を用いた実装の詳細
- 潜在的なリスクとエッジケース
- 優先度の高い推奨事項

5. **アクションプランの作成**
ディスカッションラウンドの後、実行可能なプランをまとめます。
- すぐに実装すべき項目（高優先度）
- 短期的な改善（中優先度）
- 長期的な検討事項（低優先度）
- 実装ガイドラインと回避すべきアンチパターン
実行プランは.claude/tasks 以下にyyyy-mm-dd_概要.md(例：2025-07-04_Viteサーバーが起動できない)のファイル名で作成してください。
ユーザーが「進めてください」などと指示するまでは実行はしません。

6. **ディスカッションログを保存**
ディスカッション全体は、今後の参考資料:
```bash
# 必要に応じてディスカッションログディレクトリを作成
!mkdir -p .claude/discussion_logs

# タイムスタンプ付きログを保存
!echo "[ディスカッション内容]" > .claude/discussion_logs/gemini_discussion_$(date +%Y%m%d_%H%M%S).md
```

## 使用例

### 基本的なディスカッション
```
/p-discuss-with-gemini
```
現在の Git の変更と作業コンテキストを分析します

### 特定のトピックに関するディスカッション
```
/p-discuss-with-gemini GraphQL スキーマの最適化
```
特定の領域に焦点を絞ったディスカッション

### ファイル固有の分析
```
/p-discuss-with-gemini 実装を確認しますbackend/apps/cotomu/domain/usecases/file_operations.go
```
Gemini のインサイトを用いて特定のファイルを分析します

### 詳細分析モード
```
/p-discuss-with-gemini --deep 大容量ファイルアップロードのパフォーマンス最適化
```
デフォルトの 3 ラウンドではなく 5 ラウンドのディスカッションを実施します

## 追加手順
$ARGUMENTS

## 期待される成果
- コード品質の問題に対する理解の深化
- 例を用いた具体的な改善提案
- 実装のための優先順位付けされたアクション項目
- アーキテクチャ上の決定事項のドキュメント化
- 潜在的な問題の早期検出

## 注意事項
- AI との最適なインタラクションのため、ディスカッションはすべて英語で行われます
- 各ディスカッションラウンドは、以前のインサイトに基づいて構築されます
- 最終的なアクションプランには、該当する場合、具体的なコード例が含まれます
- すべてのディスカッションは、将来の参照と意思決定の追跡のために記録されます