# フードログアプリ要件定義書

## 概要
Ever Foodライクなフードログアプリ（WebアプリPoC版）

## 技術スタック
- **フロントエンド**: React + Vite + Tailwind CSS
- **データベース**: IndexedDB（Dexie.js使用）
- **デプロイ**: GitHub Pages等の静的サイト
- **完全フロントエンド完結型**（バックエンド不要）

## 機能要件

### 基本機能
- **写真撮影・アップロード**
  - カメラアクセス（navigator.mediaDevices.getUserMedia）
  - ファイルアップロード対応
  - 自動圧縮（Canvas使用）
  - 解像度：長方形保持（16:9または4:3）
  - ファイルサイズ：200-500KB目標

- **コメント入力**
  - テキストエリア
  - 文字数制限なし

- **位置情報取得**
  - GPS座標取得（navigator.geolocation）
  - 座標のまま保存（逆ジオコーディング不要）
  - 地図表示機能（GoogleMaps API or OpenStreetMap）

- **タグ機能**
  - 自由入力式
  - 複数タグ対応
  - カンマ区切りまたはスペース区切り

- **お気に入り機能**
  - ★マークでお気に入り登録
  - お気に入り一覧表示

### 表示機能
- **カード形式表示**（メイン）
  - 写真、コメント、タグ、日時、位置情報を表示
  - 時系列順（新しい順）

- **検索機能**
  - 日付絞り込み
  - タグ検索
  - コメント検索（LIKE演算子使用）
  - 全文検索は後回し

### 編集機能
- **編集機能**
  - 投稿後の修正可能
  - 写真以外すべて編集可能

- **削除機能**
  - 確認ダイアログ付き削除
  - 完全削除

## データ構造

### 食事記録オブジェクト
```javascript
{
  id: number,                    // タイムスタンプベースのID
  photo: Blob,                   // 圧縮済み写真データ
  comment: string,               // コメント
  tags: Array<string>,           // タグ配列
  location: {                    // 位置情報
    lat: number,
    lng: number,
    accuracy: number
  },
  timestamp: Date,               // 投稿日時
  favorite: boolean,             // お気に入りフラグ
  createdAt: Date,               // 作成日時
  updatedAt: Date                // 更新日時
}
```

## UI/UX要件

### レスポンシブデザイン
- モバイルファースト
- PWA対応検討

### 基本画面構成
1. **メイン画面（Home）**: カード一覧 + 検索バー + フローティング撮影ボタン
2. **撮影・投稿画面（Create）**: 写真撮影 + 入力フォーム
3. **詳細画面（Detail）**: 1件の詳細表示 + 地図 + 編集・削除ボタン
4. **編集画面（Edit）**: 投稿内容修正

### 画面遷移設計

#### 画面遷移フロー
```
メイン画面
├── [+ボタン] → 撮影・投稿画面
│               ├── [投稿] → メイン画面（投稿完了）
│               └── [キャンセル] → メイン画面
│
├── [カードタップ] → 詳細画面
│                   ├── [編集] → 編集画面
│                   │           ├── [保存] → 詳細画面
│                   │           └── [キャンセル] → 詳細画面
│                   ├── [削除] → メイン画面（削除完了）
│                   └── [戻る] → メイン画面
│
└── [検索] → メイン画面（フィルタ済み）
```

#### React Router構成
```javascript
const routes = [
  { path: '/', element: <HomePage /> },           // メイン画面
  { path: '/create', element: <CreatePage /> },   // 撮影・投稿画面
  { path: '/detail/:id', element: <DetailPage /> }, // 詳細画面
  { path: '/edit/:id', element: <EditPage /> }    // 編集画面
]
```

#### 画面別機能詳細

**メイン画面（/）**
- カード形式で食事記録一覧表示
- 検索バー（日付・タグ・コメント）
- フローティング+ボタン（撮影画面へ）
- お気に入りフィルタ

**撮影・投稿画面（/create）**
- カメラプレビュー or ファイルアップロード
- 写真の自動圧縮処理
- コメント入力エリア
- タグ入力（自由入力式）
- GPS位置情報取得ボタン
- 投稿ボタン・キャンセルボタン

**詳細画面（/detail/:id）**
- 写真の拡大表示
- 全ての投稿情報表示
- 地図表示（座標ベース）
- 編集・削除ボタン
- 戻るボタン

**編集画面（/edit/:id）**
- 投稿画面と同様のレイアウト
- 既存データがプリセット
- 写真変更不可
- 保存・キャンセルボタン

## 将来対応予定
- リスト表示形式
- カレンダー表示形式
- エクスポート機能（JSON/CSV）
- バックエンド対応（クラウド同期）
- スマホアプリ化（React Native）

## 除外機能
- 統計機能
- 全文検索（当面）
- 複数人共有
- リアルタイム同期
- 逆ジオコーディング

## 開発優先度

### Phase 1 (MVP)
1. 基本CRUD機能
2. 写真撮影・圧縮
3. カード表示
4. 位置情報取得

### Phase 2
1. 検索機能
2. お気に入り機能
3. 地図表示
4. 編集・削除

### Phase 3
1. UIの洗練
2. パフォーマンス最適化
3. PWA対応

## 技術的考慮事項

### パフォーマンス
- 画像の遅延読み込み
- 仮想スクロール（大量データ対応）
- IndexedDBクエリ最適化

### セキュリティ
- XSS対策
- 位置情報の適切な取り扱い

### 互換性
- モダンブラウザ対応
- カメラAPI対応ブラウザ必須